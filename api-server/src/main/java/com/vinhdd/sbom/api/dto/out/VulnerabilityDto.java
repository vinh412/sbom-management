package com.vinhdd.sbom.api.dto.out;

import com.vinhdd.sbom.api.model.Vulnerability;
import lombok.Builder;
import lombok.Data;

import java.util.List;

@Data
@Builder
public class VulnerabilityDto {
    private Long id;
    private String vulId;
    private String displayName;
    private String title;
    private String description;
    private Double cvssScore;
    private String cvssVector;
    private String cwe;
    private String cve;
    private String reference;
    private List<String> externalReferences;

    public static VulnerabilityDto from(Vulnerability vulnerability) {
        return VulnerabilityDto.builder()
                .id(vulnerability.getId())
                .vulId(vulnerability.getVulId())
                .displayName(vulnerability.getDisplayName())
                .title(vulnerability.getTitle())
                .description(vulnerability.getDescription())
                .cvssScore(vulnerability.getCvssScore())
                .cvssVector(vulnerability.getCvssVector())
                .cwe(vulnerability.getCwe())
                .cve(vulnerability.getCve())
                .reference(vulnerability.getReference())
                .externalReferences(vulnerability.getExternalReferences())
                .build();
    }

}
